<!DOCTYPE html>
<html dir="rtl" lang="ar" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>تفاصيل المنتج - TARGET</title>
    <link href="../css/main.css" rel="stylesheet">
    <link href="../css/header.css" rel="stylesheet">
    <link href="../css/product.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
<!-- Header -->
<header>
    <nav class="navbar">
        <div class="logo">
            <a href="../index.html">
                <img src="../assets/c_logo/logo.png" alt="TARGET Logo">
            </a>
        </div>
        <div class="nav-links">
            <a href="../index.html">الرئيسية</a>
            <a href="about.html">من نحن</a>
            <div class="dropdown">
                <a href="#" class="dropbtn" onclick="toggleDropdown(event)">
                    معرض المنتجات <i class="fas fa-caret-down"></i>
                </a>
                <div class="dropdown-content">
                    <!-- نفس قائمة المنتجات السابقة -->
                </div>
            </div>
            <a href="contact.html">تواصل معنا</a>
        </div>
        <div class="nav-buttons">
            <button class="search-btn"><i class="fas fa-search"></i></button>
            <button class="lang-btn">الكتالوج</button>
        </div>
    </nav>
</header>

<main>
    <!-- Breadcrumb -->
    <section class="breadcrumb-section">
        <div class="container">
            <div class="breadcrumb">
                <a href="../index.html">الرئيسية</a>
                <span>/</span>
                <a id="categoryLink" href="products.html"></a>
                <span>/</span>
                <span id="productName" class="current"></span>
            </div>
        </div>
    </section>

    <!-- Product Content -->
    <div class="container">
        <div class="product-content">
            <!-- Product Gallery -->
            <div class="product-gallery">
                <div class="main-image">
                    <img id="productImage" src="" alt="">
                </div>
            </div>

            <!-- Product Info -->
            <div class="product-info">
                <h1 id="productTitle" class="product-title"></h1>
                <div class="product-meta">
                    <span>الفئة: </span>
                    <span id="productCategory" class="category-name"></span>
                </div>
                <div class="product-description">
                    <p id="productDescription"></p>
                </div>
                <div class="contact-button">
                    <a href="https://wa.me/message/MXZP62ZK6RCVF1" target="_blank" class="whatsapp-btn">
                        <i class="fab fa-whatsapp"></i>
                        <span>تواصل معنا للمزيد من التفاصيل</span>
                    </a>
                </div>
            </div>
        </div>

        <!-- Related Products -->
        <!-- Related Products -->
        <section class="related-products">
            <h2>منتجات ذات صلة</h2>
            <div class="related-slider-container">
                <button class="slider-btn prev-btn" id="prevBtn">
                    <i class="fas fa-chevron-left"></i>
                </button>

                <div class="related-slider" id="relatedProductsSlider">
                    <!-- المنتجات ستضاف هنا عن طريق JavaScript -->
                </div>

                <button class="slider-btn next-btn" id="nextBtn">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </section>
    </div>
</main>

<!-- Footer -->
<footer class="footer">
    <div class="footer-container">
        <div class="footer-content">
            <!-- معلومات الاتصال على اليمين -->
            <div class="contact-info">
                <div class="contact-details">
                    <p><i class="fas fa-phone"></i><span>اتصل بنا: 01025690100</span></p>
                    <p><i class="fas fa-envelope"></i><span>eldenfakhr31@gmail.com</span></p>
                    <p><i class="fas fa-map-marker-alt"></i><span>العنوان: القاهرة، مصر</span></p>
                </div>
            </div>

            <!-- الروابط في المنتصف -->
            <div class="footer-middle">
                <div class="footer-links">
                    <a href="../index.html">الرئيسية</a>
                    <a href="../pages/about.html">من نحن</a>
                    <a href="../pages/contact.html">تواصل معنا</a>
                </div>
                <div class="social-icons">
                    <a class="social-icon" href="https://www.tiktok.com/@sayed.m7mod" aria-label="تيك توك" target="_blank">
                        <i class="fa-brands fa-tiktok"></i>
                    </a>
                    <a class="social-icon" href="https://wa.me/message/MXZP62ZK6RCVF1" aria-label="واتساب" target="_blank">
                        <i class="fa-brands fa-whatsapp"></i>
                    </a>
                    <a class="social-icon" href="https://www.instagram.com/t_arget45" aria-label="إنستجرام" target="_blank">
                        <i class="fa-brands fa-instagram"></i>
                    </a>
                    <a class="social-icon" href="https://www.facebook.com/target.alharam" aria-label="فيسبوك" target="_blank">
                        <i class="fa-brands fa-facebook-f"></i>
                    </a>
                </div>
            </div>

            <!-- اللوجو على اليسار -->
            <div class="footer-logo">
                <img src="../assets/c_logo/logo.png" alt="TARGET Logo">
            </div>
        </div>

        <div class="footer-bottom">
            <p class="copyright">جميع الحقوق محفوظة © 2024 TARGET</p>
        </div>
    </div>
</footer>
<script>
    document.addEventListener('DOMContentLoaded', async () => {
        const currentProduct = JSON.parse(localStorage.getItem('selectedProduct'));

        if (currentProduct) {
            // تحديث تفاصيل المنتج
            document.getElementById('productName').textContent = currentProduct.name;
            document.getElementById('productTitle').textContent = currentProduct.name;
            document.getElementById('productCategory').textContent = currentProduct.category;
            document.getElementById('categoryLink').textContent = currentProduct.category;
            document.getElementById('categoryLink').href = `products.html?category=${currentProduct.category}`;
            document.getElementById('productDescription').textContent = currentProduct.description || 'لا يوجد وصف متاح';
            document.getElementById('productImage').src = currentProduct.image;
            document.title = `${currentProduct.name} - TARGET`;

            // تحميل المنتجات ذات الصلة
            try {
                const response = await fetch('http://localhost:5000/api/products');
                const allProducts = await response.json();

                const relatedProducts = allProducts.filter(product =>
                    product.category === currentProduct.category &&
                    product._id !== currentProduct._id
                ).slice(0, 4); // عرض أول 4 منتجات فقط

                const relatedProductsContainer = document.getElementById('relatedProducts');
                relatedProductsContainer.innerHTML = relatedProducts.map(product => `
                        <div class="related-product" onclick="handleRelatedProductClick(${JSON.stringify(product)})">
                            <div class="related-product-image">
                                <img src="${product.image}" alt="${product.name}">
                            </div>
                            <div class="related-product-info">
                                <h3 class="related-product-title">${product.name}</h3>
                                <div class="related-product-category">${product.category}</div>
                            </div>
                        </div>
                    `).join('');

            } catch (error) {
                console.error('Error loading related products:', error);
            }
        } else {
            window.location.href = 'products.html';
        }
    });

    function handleRelatedProductClick(product) {
        localStorage.setItem('selectedProduct', JSON.stringify(product));
        window.location.reload();
    }

    function toggleDropdown(event) {
        event.preventDefault();
        const dropdownContent = event.target.nextElementSibling;
        dropdownContent.classList.toggle('show');
    }
</script>
<script>
    document.addEventListener('DOMContentLoaded', async () => {
        const currentProduct = JSON.parse(localStorage.getItem('selectedProduct'));

        if (currentProduct) {
            // تحديث تفاصيل المنتج الأساسية...

            // تحميل وعرض المنتجات ذات الصلة
            try {
                const response = await fetch('http://localhost:5000/api/products');
                const allProducts = await response.json();

                const relatedProducts = allProducts.filter(product =>
                    product.category === currentProduct.category &&
                    product._id !== currentProduct._id
                );

                if (relatedProducts.length > 0) {
                    initializeRelatedProductsSlider(relatedProducts);
                }

            } catch (error) {
                console.error('Error loading related products:', error);
            }
        } else {
            window.location.href = 'products.html';
        }
    });

    function initializeRelatedProductsSlider(products) {
        const slider = document.getElementById('relatedProductsSlider');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');

        let currentGroup = 0;
        const productsPerGroup = 4;
        const totalGroups = Math.ceil(products.length / productsPerGroup);

        function showGroup(groupIndex) {
            const start = groupIndex * productsPerGroup;
            const end = start + productsPerGroup;
            const groupProducts = products.slice(start, end);

            slider.innerHTML = groupProducts.map(product => `
            <div class="related-product" onclick="handleRelatedProductClick(${JSON.stringify(product)})">
                <div class="related-product-image">
                    <img src="${product.image}" alt="${product.name}">
                </div>
                <div class="related-product-info">
                    <h3 class="related-product-title">${product.name}</h3>
                    <div class="related-product-category">${product.category}</div>
                </div>
            </div>
        `).join('');

            // تحديث حالة الأزرار
            prevBtn.disabled = groupIndex === 0;
            nextBtn.disabled = groupIndex === totalGroups - 1;
        }

        // عرض المجموعة الأولى
        showGroup(0);

        // إضافة مستمعي الأحداث للأزرار
        prevBtn.addEventListener('click', () => {
            if (currentGroup > 0) {
                currentGroup--;
                showGroup(currentGroup);
            }
        });

        nextBtn.addEventListener('click', () => {
            if (currentGroup < totalGroups - 1) {
                currentGroup++;
                showGroup(currentGroup);
            }
        });
    }
</script>
</body>
</html>